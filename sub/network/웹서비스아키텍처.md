**웹 서비스 기본 구조**
(종합적인 구조)
(네트워크 + 백엔드 개발에 도움될 만한 내용)
(웹 서비스를 이루고 있는 기술에 대해 종합적인 설명)

네트워크같은 인프라 스트럭처에 대해서 공부를 할 때 가장 중요한건 전체적인 구조를 이해하는 것이다.

![](https://velog.velcdn.com/images/ninto_2/post/fd6bacc2-75a4-4026-9407-0bc41cc8a0fe/image.png)

기본적으로는 웹 서비스에 쓰는 통신 프로토콜이 HTTP
HTTP는 TCP/IP 연결 그 다음에 존재한다.
그러니까 HTTP 트래픽이라 하는것은 Socket 수준에서 만들어지는 거고 Stream(끝을 알기어려운 데이터가 쭉~ 나열되는 것 - 언제끝날지 모름)
네트워크로 무언가 보낼때(TCP/IP같은 인터넷 네트워크 - IP에서는 MTU가 1500밖에 안되니까 TCP같은 경우는 일정 데이터를 댕강 댕강 잘라야 된다.

- 이런 조각 하나를 Segment라고 한다면 -> 이 세그먼트를 Packet(패켓)으로 인캡슐레이션해가지고 네트워크로 전송-> 이렇게 Stream데이터는 분해가 난다)
  (그래서 HTTP 트래픽은 가로 형태로 쭉 늘고 이걸 조각조각내서 패킷으로 만들어서 IP스택 쪽에서 전송)
  (웹에 대한 얘기를 할때는 기본적으로 패킷이니 세그먼트니 이런 얘기는 안나옴 - 트래픽이 쪼개진 수준에서의 얘기다)
  (특히 송수신 프로토콜인 HTTP는 문자열로 되어있다- 기본구조는 굉장히 간단하다
  -> [문서 주세요 -> 문서 줌] 이게 쌍을 이룬다. )

![](https://velog.velcdn.com/images/ninto_2/post/a568f5fa-fd5b-44aa-a35f-9b3ec279941b/image.png)

Web이라는 기술을 이야기하면서 티모시 버너스리 선생님에 대해 이야기를 했었다.
웹을 이루어고 있는 가장 근간이 되는 두 축의 기술이라고 하는 것은 HTML(문서),HTTP(그걸 실어나름)
그래서 초창기에는 이런 PC를 포함해서 인터넷에 연결되있고 쳤을때, 어떤 서버(기본적으로 웹서버)가 있다고 가정했을때,
보통의 경우 이 웹서버 앞에 보통의 경우 라우터같은 기본적인 장비들을 빼고서라도 3개정도가 앞단에 붙어있기 마련이다.

```
PC oㅡInternetㅡoㅁ-ㅁ-ㅁㅡweb서버
```

PC수준에서 먼저 살펴보면 여기는 클라이언트가 된다.(기본적으로 브라우저)
웹기술이라는게 HTML,HTTP로 구현된다는 하지만, 대전제가 클라이언트와 서버 둘 간에 TCP연결을 전제하게 된다.
(TCP/IP 기반에서 연결이 존재하는데 이 연결을 기반으로 HTTP통신이 이루어진다.)
(연결이라는 이야기를 하면서 상태를 얘기했는데, HTTP는 상태가 없기때문에 최근에 되게 각광받고 있다.)
(HTTP가 가지고 있는 중요한 특징이 있는데 HTTP는 Stateless다. (상태개념이 없음))
초기에 web을 만들었을때 HTML이라는 것은 기본적으로 문서라고 말했는데, 초창기 웹 클라이언트에 해당하는 웹 브라우저 본질적인 역할이 문서뷰어였음.
기존의 문서뷰어랑 결정적으로 달랐던 것은 당대의 신기술인 인터넷 기술을 적용해서 웹 서버에 저장되어 있는 이 리소스를 브라우저 쪽에서 주소창에다 입력을 해서 IP주소를 통해서 접속한 다음 TCP연결을 실시하고, 그 연결을 기반으로 HTTP통신이 이루어짐
클라이언트에서 서버로 리퀘스트가 갈때 http통신을 하는데 리퀘스트가 날라감, 이때 메서드가 GET하는거 문서
웹서버는 이러한 리퀘스트를 수신한 다음에 리스폰스를 보내줌
클라이언트에선 다음화면으로 전환이 될텐데 브라우저가 문서뷰어다 보니까 날라오는 HTML문서를 화면에 표시해줌
이게 초창기 웹이다. (날라온 파일은 문서뷰어에 link -> link클릭하면 마치 처음 찾아온것처럼 되풀이됐던거)

소프트웨어를 개발할때 설계원칙이라는게 있다.
이런 설계 원칙 관련된거 보면 결국은 뭔가 3개를 구분하라고 되있음
UI와 DATA의 영역은 구분, 제어체계 이 3개를 같이 섞어놓으면 안좋음
분리시켜놓는게 통상의 원칙
결국 원칙이라는게 유지보수 문제를 따짐
이걸 다 섞어서 하나의 모듈로 개발하면 만약 자료구조 변경하면 화면 고쳐야됨 또는 화면을 고쳤더니 자료구조를 뜯어고쳐야되는 등의 문제 발생

초창기에는 문서가 잘 날라오니까 좋았는데 해보니까 문서를 예쁘게 꾸미기 위해서 문법들을 더 집어넣었음
문서 그자체(Data), 예쁘게 꾸미는(UI)를 분리하게 됨
HTML에 한번에 기술할 수 있었지만, 이걸 따로 뺌
이렇게 해서 탄생한게 css , 즉 stylesheet가 필요해지게됨
HTML(Data) + CSS 까지 요청을 보내게 됨

1990년대 중반으로 넘어오면서, 지금은 잘쓰지않는 문서뷰어계의 네스케이프 네비게이터가 나타남
문서라는게 정확히 말하면 정적인 문서(책 같은거)
이 정적인 문서에 움직임을 넣어준다거나 그 내용이 그때그때 바뀔 수 있는 동적인 제어가 가능한 진보한 무언가를 만들려고 노력했음
문서에 대고 동적을 말하는 녀석을 반영
이 모든 움직임에는 규칙이라는게 따르게 되는거고 이게 Script형태로 기술하게 됨
그래서 탄생한 얘가 첫번째가 Mocha Script -> Live Script -> JavaScript

옛날에 문서가 날라오면 화면에 렌더링을 해야하는데
그 전에 1.구문분석부터 해야됨 -> 일단 text 내용이 있고 + tag
이 둘을 분리해서 tag에 맞게 2.렌더링
여기에 스크립트도 들어가버리니까 3.자바스크립트 엔진까지 들어가게 됨

오늘날의 컴퓨터 브라우저를 얘기하자면, 위 녀석들이 가장 기본적인 구성요소가 되어줌

이 코드라는것이 결국은 서버에 위치하게 됨
이제 HTML (+ jpg같은 이미지)+ CSS + JS까지 날라감
이런것들이 http.reponse 이런식으로 웹기술이 발전하게 됨

정적웹에서 동적인 웹의 시대가 열림
GET은 다운로드 성격이 굉장히 강했는데, 이 문서자료를 클라이언트가 서버한테 요청을 하면 서버가 주는데
뭔가 달라고하면 보내주는 이런 작용이 단방향 (정적인)
그래서 클라이언트는 문서자료 콘텐츠에 개입할 방법이 없었고 상호작용을 기대하기 어려웠음

이런부분들을 해결하기 위해 더 고민하게 되었는데,
이때 여러 방법론이 나옴 (GET말고 다른 메서드들이 등장)
예를들어, 로그인창이 있을때 아이디와 패스워드 버튼이 있을때 이때 http.리퀘스트==POST가 등장
버튼을 클릭하면, 서버로
POST가 추가되면서 양방향으로 상호작용을 하게 되었는데
또 문제가 있음
이 모든 방향성이 상황작용이 포함되면 이 절차를 따르는 상태가 전이하는게 따라다니게됨
그런데 HTTP는 상태less 그래서 상태전이할때 필연전으로 이걸 어딘가에 기억해야할 필요가 생김
그래서 이 기억이라는 걸 클라이언트에도 구현하고 서버쪽에도 구현하게 됨
기억은 똑같은 내용을 양쪽이 같이하는거
그 기억이라는게 클라이언트에서는 그게 Cookie의 형태로 구현되게됨
(Cookie: 상호작용을 위한 기억의 부산물 로 기억하자)
서버는 기억해야될게 너무 많아서 도저히 안되겠다 해서 나온게 DB(데이터베이스)로 만들게됨
그래서 웹 서버외에도 DB서버가 생겨났고 여기서 클라이언트와 무언가를 기억하게 된것이다.

만약 로그인상황에서 아이디와 패스워드 입력하고 POST로 날라가는데
`POST id='아이디'&password='1234'` 여기서 중요한것은 '아이디', '1234'이런 얘들이 서버관점에서 **원격지 사용자 입력**이라고 본다.
서버관점에선 이걸 신뢰하면 안된다. 이건 **반드시 검증대상**이다.
데이터베이스에가서 조사를 함, 얘한테 질의를 날림 `select*Prom ~~ where id='아이디'and password='1234'`이런식으로 찾아달라고 SQL문이 작동하게됨
문제는, 웹서버가 데이터베이스에 직접 접근하는건 아니고 중간에 중계역할을 하는 서버가 하나 더 들어감
그래서 보통 웹서비스는 서버 3개로 연결되있음
중간에 있는 서버를 통해 오른쪽에 있는 데이터베이스와 연결
web서버는 송수신 담당
데이터베이스 자료담당,기억
중간서버(WAS) 어떤 연산을 처리하는 역할을 담당
그래서 아이디와 패스워드를 끌어와서 처리담당자한테 보내줌
아주 쉽게 생각하면 문서에 구멍이 뚫려있음 여기서 구멍에 아이디나 패스워드같은걸 집어넣음
이런 동적인 문서는 그때그때마다 달라지니까 서버의 처리로직에 의해 생성이 된다.
그래서 클라이언트쪽에서 입력을 보내고 해서 문서가 날라왔는데 정확히는 동적인 html문서가 날라온거
브라우저 상에서 화면이 아이디에 맞춰 '아이디'님 안녕하세요 이런식으로 바뀌게 될 것임
보통 여러 인터페이스가 연결된 형태가 있는데 ODBC, JDBC등의 방법론으로 데이터베이스와 처리서버가 연결되있고
이 인터페이스타고 조회를 하는 이런게 Found, 항상 찾을 수 는 없기때문에 그때는 not Found가 됨(클라이언트에선 못찾았다는 화면으로 바뀜)
이런 처리를 담당하는 서버를 WAS라고 부름(눈에 보이는 역할 View, Model, Control이 들어감 -> 이게 MVC 아키텍처가 됨)
